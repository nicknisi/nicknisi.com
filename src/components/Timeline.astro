---
interface TimelineEvent {
  time: string;
  text: string;
  video?: string;
  image?: string;
  color?: string;
}

interface Props {
  events: TimelineEvent[];
  reverse?: boolean;
}
const { events, reverse } = Astro.props;
if (reverse) {
  events.reverse();
}

---

<style>
/* TIMELINE
–––––––––––––––––––––––––––––––––––––––––––––––––– */

.timeline ul {
  @apply py-12 px-0;
}

.timeline ul li {
  @apply ml-5 bg-white pt-12 my-0 md:mx-auto w-[6px] relative list-none;
}

.timeline ul li::after {
  content: "";
  transform: translateX(-50%);
  @apply absolute left-1/2 bottom-0 w-8 h-8 rounded-full z-10;
}

.timeline ul li div {
  @apply w-64 md:w-96 relative bottom-0 p-4 bg-purple-300;
}

.timeline ul li div::before {
  content: "";
  @apply absolute bottom-2 w-0 h-0 border-solid;
}

.timeline ul li:nth-child(odd) div {
  @apply left-11;
}

.timeline ul li:nth-child(odd) div::before {
  border-color: transparent;
  @apply outline-none -left-4 border-r-[16px] border-y-[8px] border-r-purple-300;
}

.timeline ul li:nth-child(even) div {
  @apply md:-left-[439px] left-12;
}

.timeline ul li:nth-child(even) div::before {
  border-color: transparent;
  @apply border-y-8 -left-4 border-r-[16px] border-r-purple-300
  md:left-auto md:-right-4 md:border-l-[16px] md:border-r-0 md:border-l-purple-300;
}

.time {
  @apply block text-lg font-bold mb-2
}


/* EFFECTS
–––––––––––––––––––––––––––––––––––––––––––––––––– */

.timeline ul li::after {
  transition: background 0.5s ease-in-out;
}

.timeline ul li.in-view::after {
  @apply bg-purple-300;
}

/* .timeline ul li div { */
/*   visibility: hidden; */
/*   opacity: 0; */
/*   transition: all 0.5s ease-in-out; */
/* } */

.timeline ul li:nth-child(odd) div {
  transform: translate3d(200px, 0, 0);
}

.timeline ul li:nth-child(even) div {
  transform: translate3d(-200px, 0, 0);
}

.timeline ul li.in-view div {
  @apply visible transform-none opacity-100;
}
</style>

<script>
(function () {
  "use strict";

  // define variables
  var items = document.querySelectorAll(".timeline li");

  // check if an element is in viewport
  // http://stackoverflow.com/questions/123999/how-to-tell-if-a-dom-element-is-visible-in-the-current-viewport
  function isElementInViewport(el) {
    var rect = el.getBoundingClientRect();
    return (
      rect.top >= 0 &&
      rect.left >= 0 &&
      rect.bottom <=
        (window.innerHeight || document.documentElement.clientHeight) &&
      rect.right <= (window.innerWidth || document.documentElement.clientWidth)
    );
  }

  function callbackFunc() {
    for (var i = 0; i < items.length; i++) {
      if (isElementInViewport(items[i])) {
        items[i].classList.add("in-view");
      }
    }
  }

  // listen for events
  window.addEventListener("load", callbackFunc);
  window.addEventListener("resize", callbackFunc);
  window.addEventListener("scroll", callbackFunc);
})();
</script>

<section class="timeline">
  <ul>
    {events.map((event) => (
      <li>
        <div>
          <time class="time">{event.time}</time>
          <p>{event.text}</p>
        </div>
      </li>
    ))}
</section>
